this.BX=this.BX||{};this.BX.Vote=this.BX.Vote||{};(function(e,t){"use strict";const s="im";const a="Bitrix\\Vote\\Attachment\\ImMessageConnector";var r=babelHelpers.classPrivateFieldLooseKey("entityId");var o=babelHelpers.classPrivateFieldLooseKey("app");var l=babelHelpers.classPrivateFieldLooseKey("getAttachedVote");var i=babelHelpers.classPrivateFieldLooseKey("sendVoteStopRequest");var c=babelHelpers.classPrivateFieldLooseKey("sendVoteRevokeRequest");var d=babelHelpers.classPrivateFieldLooseKey("sendBackendVote");var n=babelHelpers.classPrivateFieldLooseKey("getEntityParams");var v=babelHelpers.classPrivateFieldLooseKey("updateStore");class b{constructor(e,s){Object.defineProperty(this,v,{value:F});Object.defineProperty(this,n,{value:B});Object.defineProperty(this,d,{value:P});Object.defineProperty(this,c,{value:p});Object.defineProperty(this,i,{value:h});Object.defineProperty(this,l,{value:u});Object.defineProperty(this,r,{writable:true,value:void 0});Object.defineProperty(this,o,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,r)[r]=s;babelHelpers.classPrivateFieldLooseBase(this,o)[o]=t.VoteApplication.init()}load(){return new Promise(((e,t)=>{babelHelpers.classPrivateFieldLooseBase(this,l)[l]().then((t=>{var s;babelHelpers.classPrivateFieldLooseBase(this,v)[v](t==null?void 0:(s=t.data)==null?void 0:s.attach);e(true)})).catch((e=>t(e)))}))}sendVote(e){return babelHelpers.classPrivateFieldLooseBase(this,d)[d](e).then((e=>{var t,s;babelHelpers.classPrivateFieldLooseBase(this,v)[v](e==null?void 0:(t=e.data)==null?void 0:t.attach);return e==null?void 0:(s=e.data)==null?void 0:s.attach}))}revokeVote(){return new Promise(((e,t)=>{babelHelpers.classPrivateFieldLooseBase(this,c)[c]().then((t=>{var s;babelHelpers.classPrivateFieldLooseBase(this,v)[v](t==null?void 0:(s=t.data)==null?void 0:s.attach);e(true)})).catch((e=>{console.error(e.errors[0].code);t(e)}))}))}completeVote(){return new Promise(((e,t)=>{babelHelpers.classPrivateFieldLooseBase(this,i)[i]().then((()=>{e(true)})).catch((e=>{console.error(e.errors[0].code);t(e)}))}))}}function u(){return BX.ajax.runAction("vote.AttachedVote.get",{data:babelHelpers.classPrivateFieldLooseBase(this,n)[n]()})}function h(){return BX.ajax.runAction("vote.AttachedVote.stop",{data:babelHelpers.classPrivateFieldLooseBase(this,n)[n]()})}function p(){return BX.ajax.runAction("vote.AttachedVote.recall",{data:babelHelpers.classPrivateFieldLooseBase(this,n)[n]()})}function P(e){return BX.ajax.runAction("vote.AttachedVote.vote",{data:{...babelHelpers.classPrivateFieldLooseBase(this,n)[n](),ballot:e}})}function B(){return{moduleId:s,entityType:a,entityId:babelHelpers.classPrivateFieldLooseBase(this,r)[r]}}function F(e){if(!e){return}babelHelpers.classPrivateFieldLooseBase(this,o)[o].getStore().dispatch("vote/setCurrentUserVotes",e.userAnswerMap);babelHelpers.classPrivateFieldLooseBase(this,o)[o].getStore().dispatch("vote/addVote",e);babelHelpers.classPrivateFieldLooseBase(this,o)[o].getStore().dispatch("vote/addQuestion",e.QUESTIONS);babelHelpers.classPrivateFieldLooseBase(this,o)[o].getStore().dispatch("vote/addAnswer",e.QUESTIONS)}e.BackendModuleId=s;e.BackendEntityType=a;e.ImVoteService=b})(this.BX.Vote.Service=this.BX.Vote.Service||{},BX.Vote);
//# sourceMappingURL=vote-service.bundle.map.js