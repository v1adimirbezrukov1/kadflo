<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____1918687691']= array(base64_decode('aXNfc'.'3'.'RyaW5n'),base64_decode('c3RydG9sb3d'.'lcg=='),base64_decode('aXNfYXJyYXk='),base64_decode(''.'aXNfc3RyaW5'.'n'),base64_decode('Z'.'3pkZW'.'Nv'.'ZGU='),base64_decode('Ym'.'FzZTY0X2RlY29kZQ=='),base64_decode(''.'dXJsZGVjb2Rl'),base64_decode(''.'Y'.'XJyY'.'Xlfc'.'mV2'.'ZXJzZQ'.'=='),base64_decode('Z3pl'.'bmNvZGU'.'='),base64_decode('Ym'.'FzZTY0'.'X2V'.'uY29kZQ=='),base64_decode('dXJsZW'.'5jb2Rl'),base64_decode('Ymlu'.'Mmhl'.'eA='.'='),base64_decode(''.'aX'.'NfYXJyYXk'.'='),base64_decode('c'.'3RydG9sb'.'3dl'.'c'.'g=='),base64_decode('a'.'XNfYXJ'.'yYX'.'k='),base64_decode('am9pb'.'g='.'='),base64_decode('Zm'.'5'.'tYXRja'.'A=='),base64_decode('cmF3d'.'XJsZGVjb2Rl'),base64_decode('c3Vic3Ry'),base64_decode('c3V'.'ic'.'3Ry'),base64_decode(''.'c3RyX3JlcGxhY'.'2U='),base64_decode('cHJlZ19x'.'dW90ZQ='.'='),base64_decode(''.'cHJlZ19tYXR'.'jaA=='));if(!function_exists(__NAMESPACE__.'\\___114474153')){function ___114474153($_1178860786){static $_603935171= false; if($_603935171 == false) $_603935171=array('YWN0aW9u','aW50dmFs',''.'cGF'.'0'.'aA='.'=',''.'Y29u'.'dGV4dA='.'=',''.'a'.'2'.'V5cw==','cHJvY'.'2Vzcw='.'=',''.'ZW5jb'.'2R'.'pbmc=',''.'cHJlZ19yZX'.'BsYW'.'N'.'l','c'.'GF'.'0a'.'A='.'=','Y'.'29udGV4'.'d'.'A==','a2V5cw==','c'.'HJvY2Vzcw==','Z'.'W'.'5'.'jb2'.'Rpbmc'.'=','cGF0dGV'.'ybg==','c'.'HJ'.'lZ19tYXR'.'jaA==',''.'cGF0aA='.'=','Y29'.'u'.'d'.'GV4dA==','a2V'.'5cw'.'==',''.'cH'.'J'.'v'.'Y2Vzc'.'w='.'=','Z'.'W5jb2Rp'.'bmc=','cG'.'F'.'0dG'.'V'.'ybg'.'==','cG9z'.'d'.'F9hY3Rpb'.'24'.'=','Y'.'2hlY2tf'.'Y3NyZg'.'==',''.'cGF0aA==',''.'Y29'.'u'.'dGV4dA==','a2V'.'5'.'cw==','cH'.'JvY2'.'Vz'.'c'.'w==','ZW5jb2'.'Rpbm'.'c=','c'.'GF0'.'dGVybg'.'==','YWN0aW9u','YW'.'N0a'.'W9u','YWN0'.'aW9u','YWN0aW'.'9u','YWN0aW9u','YWN'.'0aW9u',''.'cG9zdF'.'9hY'.'3'.'R'.'pb'.'24'.'=','Z'.'W5jb2Rpbmc=','ZW5jb'.'2R'.'pbmc'.'=','ZW5jb2'.'R'.'pbmc=',''.'Z'.'W5jb'.'2'.'Rpbmc=','Z'.'W5jb2'.'Rpbm'.'c=',''.'ZW5'.'jb2Rpbmc=','Z3o'.'=',''.'Y'.'mFzZTY'.'0','d'.'X'.'Js',''.'aGV'.'4','Lg'.'==',''.'L'.'w==','aW5k'.'ZXgucGhw','L2'.'luZGV4LnB'.'ocA==','U0NS'.'SVBUX05BTUU=','L2l'.'uZGV4L'.'nBocA'.'==','U0NSSVBUX05BTUU'.'=','U0N'.'SS'.'VBU'.'X05BTU'.'U=','U0'.'NS'.'SVBUX05BTUU=','fg'.'='.'=','f'.'l4'.'=','fg='.'=','XH4'.'=','JH4=');return base64_decode($_603935171[$_1178860786]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_1391134324; protected $_267434411; protected $_2028537451; protected $_1659270900; protected $_439591051; public static function make(array $_557117500):?static{ $_557117500= static::prepareRuleParameters($_557117500); return match($_557117500[___114474153(0)]){ ___114474153(1) => new IntvalRule( $_557117500[___114474153(2)], $_557117500[___114474153(3)], $_557117500[___114474153(4)], $_557117500[___114474153(5)], $_557117500[___114474153(6)]), ___114474153(7) => new PregReplaceRule( $_557117500[___114474153(8)], $_557117500[___114474153(9)], $_557117500[___114474153(10)], $_557117500[___114474153(11)], $_557117500[___114474153(12)], $_557117500[___114474153(13)]), ___114474153(14) => new PregMatchRule( $_557117500[___114474153(15)], $_557117500[___114474153(16)], $_557117500[___114474153(17)], $_557117500[___114474153(18)], $_557117500[___114474153(19)], $_557117500[___114474153(20)], $_557117500[___114474153(21)]), ___114474153(22) => new CsrfRule( $_557117500[___114474153(23)], $_557117500[___114474153(24)], $_557117500[___114474153(25)], $_557117500[___114474153(26)], $_557117500[___114474153(27)], $_557117500[___114474153(28)],), default => null,};} protected static function prepareRuleParameters(array $_142934760): array{ if($GLOBALS['____1918687691'][0]($_142934760[___114474153(29)])){ $_142934760[___114474153(30)]= $GLOBALS['____1918687691'][1]($_142934760[___114474153(31)]);} elseif($GLOBALS['____1918687691'][2]($_142934760[___114474153(32)])){ $_1134502039= $_142934760[___114474153(33)]; $_142934760[___114474153(34)]= $_1134502039[(141*2-282)]; $_142934760[___114474153(35)]= $_1134502039[round(0+0.25+0.25+0.25+0.25)];} $_142934760[___114474153(36)]=!empty($_142934760[___114474153(37)])? $_142934760[___114474153(38)]:[]; if($GLOBALS['____1918687691'][3]($_142934760[___114474153(39)])){ $_142934760[___114474153(40)]=[$_142934760[___114474153(41)]];} return $_142934760;}  public function __construct($_1391134324, $_267434411, $_2028537451, $_1659270900, $_439591051){ $this->_1391134324= $_1391134324; $this->_267434411= $this->castContext($_267434411); $this->_2028537451= $this->castKeys($_2028537451); $this->_1659270900= $_1659270900; $this->_439591051= $_439591051;} public function evaluateValue($_2145845575){ if(!empty($this->_439591051)){ foreach($this->_439591051 as $_885177329){ $_2145845575= match($_885177329){ 'gz' => $GLOBALS['____1918687691'][4]($_2145845575), 'base64' => $GLOBALS['____1918687691'][5]($_2145845575), 'url' => $GLOBALS['____1918687691'][6]($_2145845575), 'hex' => hex2bin($_2145845575)};}} $_146160620= $this->evaluate($_2145845575); if(!empty($this->_439591051) && $_146160620 instanceof ModifyResult){ $_1472602122= $_146160620->getCleanValue(); foreach($GLOBALS['____1918687691'][7]($this->_439591051) as $_885177329){ $_1472602122= match($_885177329){ ___114474153(42) => $GLOBALS['____1918687691'][8]($_1472602122), ___114474153(43) => $GLOBALS['____1918687691'][9]($_1472602122), ___114474153(44) => $GLOBALS['____1918687691'][10]($_1472602122), ___114474153(45) => $GLOBALS['____1918687691'][11]($_1472602122)};} $_146160620= new ModifyResult($_1472602122);} return $_146160620;} abstract public function evaluate($_2145845575); protected function castContext($_267434411){ if(!$GLOBALS['____1918687691'][12]($_267434411)){ $_267434411=[$_267434411];} foreach($_267434411 as $_2034884149 => $_941008020){ $_267434411[$_2034884149]= $GLOBALS['____1918687691'][13]($_941008020);} return $_267434411;} protected function castKeys($_2028537451){ if(!$GLOBALS['____1918687691'][14]($_2028537451)){ $_2028537451=[$_2028537451];} return $_2028537451;} public function matchKey(array $_400296168): bool{ $_400296168= $GLOBALS['____1918687691'][15](___114474153(46), $_400296168); foreach($this->_2028537451 as $_1094636635){   if($GLOBALS['____1918687691'][16]($_1094636635, $_400296168)){ return true;}} return false;}  public function matchPath($_301123815){ if($this->_1391134324 === '*'){ return true;}  $_1244272127= new Uri($_301123815); $_167529599= $_1244272127->getPath(); $_167529599= $GLOBALS['____1918687691'][17]($_167529599);      if(str_ends_with($_167529599, ___114474153(47))){ $_167529599 .= ___114474153(48);} $_167529599= Path::normalize($_167529599);  $_1301608265[]= $_167529599; if(str_ends_with($_167529599, ___114474153(49))){ $_1301608265[]= $GLOBALS['____1918687691'][18]($_167529599,(151*2-302),-round(0+4.5+4.5));} elseif(str_ends_with($_SERVER[___114474153(50)], ___114474153(51))){ $_1301608265[]= $GLOBALS['____1918687691'][19]($_SERVER[___114474153(52)], min(26,0,8.6666666666667),-round(0+4.5+4.5));} if($_167529599 !== $_SERVER[___114474153(53)]){ $_1301608265[]= $_SERVER[___114474153(54)];}  if(str_starts_with($this->_1391134324, ___114474153(55))){ $_1567244356= $this->_1391134324;} else{ $_1567244356= ___114474153(56). $GLOBALS['____1918687691'][20](___114474153(57), ___114474153(58), $GLOBALS['____1918687691'][21]($this->_1391134324)). ___114474153(59);} foreach($_1301608265 as $_2120064897){ if($this->_1391134324 === $_2120064897 || $GLOBALS['____1918687691'][22]($_1567244356, $_2120064897)){ return true;}} return false;}  public function getPath(){ return $this->_1391134324;}  public function getContext(){ return $this->_267434411;}  public function getKeys(){ return $this->_2028537451;}  public function getProcess(){ return $this->_1659270900;}}?>