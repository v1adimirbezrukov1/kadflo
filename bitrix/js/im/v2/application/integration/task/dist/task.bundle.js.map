{"version":3,"file":"task.bundle.js","sources":["../src/components/task-chat-opener.js","../src/task.js"],"sourcesContent":["import { Logger } from 'im.v2.lib.logger';\nimport { ChatService } from 'im.v2.provider.service';\nimport { BaseChatContent } from 'im.v2.component.content.elements';\nimport { ChatTextarea } from 'im.v2.component.textarea';\n\nimport type { ImModelChat } from 'im.v2.model';\n\nimport './css/task-chat-opener.css';\n\n// @vue/component\nexport const TaskChatOpener = {\n\tname: 'TaskChatOpener',\n\tcomponents: { BaseChatContent, ChatTextarea },\n\tprops: {\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/getByChatId'](this.chatId, true);\n\t\t},\n\t\tdialogId(): string\n\t\t{\n\t\t\treturn this.dialog.dialogId;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tvoid this.onChatOpen();\n\t},\n\tmethods: {\n\t\tasync onChatOpen()\n\t\t{\n\t\t\tif (this.dialog.inited)\n\t\t\t{\n\t\t\t\tLogger.warn(`TaskChatOpener: chat ${this.chatId} is already loaded`);\n\t\t\t\t// Analytics.getInstance().onOpenChat(this.dialog);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait this.loadChat();\n\t\t\t// Analytics.getInstance().onOpenChat(this.dialog);\n\t\t},\n\t\tasync loadChat(): Promise\n\t\t{\n\t\t\tLogger.warn(`TaskChatOpener: loading chat ${this.chatId}`);\n\t\t\tawait this.getChatService().loadChatByChatId(this.chatId);\n\t\t\tLogger.warn(`TaskChatOpener: chat ${this.chatId} is loaded`);\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-messenger__scope bx-im-task-chat-opener__container\">\n\t\t\t<div v-if=\"!dialog.inited\">...</div>\n\t\t\t<BaseChatContent v-else :dialogId=\"dialogId\" :withHeader=\"false\" :withSidebar=\"false\">\n\t\t\t\t<template #textarea=\"{ onTextareaMount }\">\n\t\t\t\t\t<ChatTextarea\n\t\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t\t:key=\"dialogId\"\n\t\t\t\t\t\t:withMarket=\"false\"\n\t\t\t\t\t\t:withAudioInput=\"false\"\n\t\t\t\t\t\t@mounted=\"onTextareaMount\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</BaseChatContent>\n\t\t</div>\n\t`,\n};\n","import { Core } from 'im.v2.application.core';\n\nimport { TaskChatOpener } from './components/task-chat-opener';\n\ntype ApplicationConfig = {\n\tchatId: number,\n};\n\nconst APPLICATION_NAME = 'TaskChatApplication';\n\nexport class TaskApplication\n{\n\t#initPromise: Promise<TaskApplication>;\n\t#config: ApplicationConfig;\n\n\tconstructor(config: ApplicationConfig = {})\n\t{\n\t\tthis.#config = config;\n\t\tthis.#initPromise = this.#init();\n\t}\n\n\tready(): Promise\n\t{\n\t\treturn this.#initPromise;\n\t}\n\n\tasync render(node: string | HTMLElement): Promise\n\t{\n\t\tawait this.ready();\n\n\t\tconst outerConfig = this.#config;\n\n\t\treturn Core.createVue(this, {\n\t\t\tname: APPLICATION_NAME,\n\t\t\tel: node,\n\t\t\tcomponents: { TaskChatOpener },\n\t\t\tdata(): { config: ApplicationConfig }\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tconfig: outerConfig,\n\t\t\t\t};\n\t\t\t},\n\t\t\ttemplate: `<TaskChatOpener :chatId=\"${this.#config.chatId}\" :config=\"config\" />`,\n\t\t});\n\t}\n\n\tasync #init(): Promise<TaskApplication>\n\t{\n\t\tawait Core.ready();\n\n\t\treturn this;\n\t}\n}\n"],"names":["TaskChatOpener","name","components","BaseChatContent","ChatTextarea","props","chatId","type","Number","required","computed","dialog","$store","getters","dialogId","created","onChatOpen","methods","inited","Logger","warn","loadChat","getChatService","loadChatByChatId","chatService","ChatService","template","APPLICATION_NAME","TaskApplication","constructor","config","ready","render","node","outerConfig","Core","createVue","el","data"],"mappings":";;;;;;;CASA;AACA,CAAO,MAAMA,cAAc,GAAG;GAC7BC,IAAI,EAAE,gBAAgB;GACtBC,UAAU,EAAE;sBAAEC,gDAAe;mBAAEC;IAAc;GAC7CC,KAAK,EAAE;KACNC,MAAM,EAAE;OACPC,IAAI,EAAEC,MAAM;OACZC,QAAQ,EAAE;;IAEX;GACDC,QAAQ,EAAE;KACTC,MAAM,GACN;OACC,OAAO,IAAI,CAACC,MAAM,CAACC,OAAO,CAAC,mBAAmB,CAAC,CAAC,IAAI,CAACP,MAAM,EAAE,IAAI,CAAC;MAClE;KACDQ,QAAQ,GACR;OACC,OAAO,IAAI,CAACH,MAAM,CAACG,QAAQ;;IAE5B;GACDC,OAAO,GACP;KACC,KAAK,IAAI,CAACC,UAAU,EAAE;IACtB;GACDC,OAAO,EAAE;KACR,MAAMD,UAAU,GAChB;OACC,IAAI,IAAI,CAACL,MAAM,CAACO,MAAM,EACtB;SACCC,uBAAM,CAACC,IAAI,CAAE,wBAAuB,IAAI,CAACd,MAAO,oBAAmB,CAAC;;;SAGpE;;OAGD,MAAM,IAAI,CAACe,QAAQ,EAAE;;MAErB;;KACD,MAAMA,QAAQ,GACd;OACCF,uBAAM,CAACC,IAAI,CAAE,gCAA+B,IAAI,CAACd,MAAO,EAAC,CAAC;OAC1D,MAAM,IAAI,CAACgB,cAAc,EAAE,CAACC,gBAAgB,CAAC,IAAI,CAACjB,MAAM,CAAC;OACzDa,uBAAM,CAACC,IAAI,CAAE,wBAAuB,IAAI,CAACd,MAAO,YAAW,CAAC;MAC5D;KACDgB,cAAc,GACd;OACC,IAAI,CAAC,IAAI,CAACE,WAAW,EACrB;SACC,IAAI,CAACA,WAAW,GAAG,IAAIC,kCAAW,EAAE;;OAGrC,OAAO,IAAI,CAACD,WAAW;;IAExB;GACDE,QAAQ,EAAG;;;;;;;;;;;;;;;;CAgBZ,CAAC;;CCvED,MAAMC,gBAAgB,GAAG,qBAAqB;CAAC;CAAA;CAAA;AAE/C,CAAO,MAAMC,eAAe,CAC5B;GAICC,WAAW,CAACC,MAAyB,GAAG,EAAE,EAC1C;KAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KACC,4CAAI,sBAAWA,MAAM;KACrB,4CAAI,wEAAgB,IAAI,iBAAQ;;GAGjCC,KAAK,GACL;KACC,+CAAO,IAAI;;GAGZ,MAAMC,MAAM,CAACC,IAA0B,EACvC;KACC,MAAM,IAAI,CAACF,KAAK,EAAE;KAElB,MAAMG,WAAW,2CAAG,IAAI,mBAAQ;KAEhC,OAAOC,2BAAI,CAACC,SAAS,CAAC,IAAI,EAAE;OAC3BnC,IAAI,EAAE0B,gBAAgB;OACtBU,EAAE,EAAEJ,IAAI;OACR/B,UAAU,EAAE;SAAEF;QAAgB;OAC9BsC,IAAI,GACJ;SACC,OAAO;WACNR,MAAM,EAAEI;UACR;QACD;OACDR,QAAQ,EAAG,4BAA2B,4CAAI,oBAASpB,MAAO;MAC1D,CAAC;;CASJ;CAAC,wBALA;GACC,MAAM6B,2BAAI,CAACJ,KAAK,EAAE;GAElB,OAAO,IAAI;CACZ;;;;;;;;"}